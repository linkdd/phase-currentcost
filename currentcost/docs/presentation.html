

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>phase-currentcost &mdash; phase-currentcost 1.0.2 documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="top" title="phase-currentcost 1.0.2 documentation" href="index.html"/>
        <link rel="next" title="Modules" href="code.html"/>
        <link rel="prev" title="phase-currentcost" href="index.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        <a href="index.html" class="fa fa-home"> phase-currentcost</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
        
            <ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="">phase-currentcost</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#usage">Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="#examples">Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="#message-send-through-rabbitmq">Message send through RabbitMQ</a></li>
<li class="toctree-l2"><a class="reference internal" href="#contribute">Contribute</a></li>
<li class="toctree-l2"><a class="reference internal" href="#license">License</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="code.html">Modules</a><ul>
<li class="toctree-l2"><a class="reference internal" href="code.html#workflow">Workflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="code.html#test-plan">Test plan</a></li>
<li class="toctree-l2"><a class="reference internal" href="code.html#utils-module">Utils module</a></li>
<li class="toctree-l2"><a class="reference internal" href="code.html#module-currentcost.messager">RabbitMQ_messager module</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="todo.html">Todo</a></li>
<li class="toctree-l1"><a class="reference internal" href="change.html">Changelog</a><ul>
<li class="toctree-l2"><a class="reference internal" href="change.html#phase-currentcost-v1-0-2-stable-urgency-low">phase-currentcost (v1.0.2) stable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="change.html#phase-currentcost-v1-0-1-stable-urgency-low">phase-currentcost (v1.0.1) stable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="change.html#phase-currentcost-v1-0-0-stable-urgency-low">phase-currentcost (v1.0.0) stable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="change.html#phase-currentcost-v0-9-17-stable-urgency-low">phase-currentcost (v0.9.17) stable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="change.html#phase-currentcost-v0-9-16-stable-urgency-low">phase-currentcost (v0.9.16) stable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="change.html#phase-currentcost-v0-9-15-stable-urgency-low">phase-currentcost (v0.9.15) stable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="change.html#phase-currentcost-v0-9-14-stable-urgency-low">phase-currentcost (v0.9.14) stable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="change.html#phase-currentcost-v0-9-13-stable-urgency-low">phase-currentcost (v0.9.13) stable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="change.html#phase-currentcost-v0-9-12-stable-urgency-low">phase-currentcost (v0.9.12) stable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="change.html#phase-currentcost-v0-9-11-stable-urgency-low">phase-currentcost (v0.9.11) stable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="change.html#phase-currentcost-v0-9-10-stable-urgency-low">phase-currentcost (v0.9.10) stable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="change.html#phase-currentcost-v0-9-9-stable-urgency-low">phase-currentcost (v0.9.9) stable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="change.html#phase-currentcost-v0-9-8-stable-urgency-low">phase-currentcost (v0.9.8) stable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="change.html#phase-currentcost-v0-9-7-stable-urgency-low">phase-currentcost (v0.9.7) stable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="change.html#phase-currentcost-v0-9-6-stable-urgency-low">phase-currentcost (v0.9.6) stable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="change.html#phase-currentcost-v0-9-5-stable-urgency-low">phase-currentcost (v0.9.5) stable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="change.html#phase-currentcost-v0-9-4-stable-urgency-low">phase-currentcost (v0.9.4) stable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="change.html#phase-currentcost-v0-9-3-stable-urgency-low">phase-currentcost (v0.9.3) stable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="change.html#phase-currentcost-v0-9-2-stable-urgency-low">phase-currentcost (v0.9.2) stable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="change.html#phase-currentcost-v0-9-1-stable-urgency-low">phase-currentcost (v0.9.1) stable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="change.html#phase-currentcost-v0-9-0-stable-urgency-low">phase-currentcost (v0.9.0) stable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="change.html#phase-currentcost-v0-8-0-unstable-urgency-low">phase-currentcost (v0.8.0) unstable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="change.html#phase-currentcost-v0-7-0-unstable-urgency-low">phase-currentcost (v0.7.0) unstable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="change.html#phase-currentcost-v0-6-0-unstable-urgency-low">phase-currentcost (v0.6.0) unstable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="change.html#phase-currentcost-v0-5-0-unstable-urgency-low">phase-currentcost (v0.5.0) unstable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="change.html#phase-currentcost-v0-4-1-unstable-urgency-low">phase-currentcost (v0.4.1) unstable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="change.html#phase-currentcost-v0-4-0-unstable-urgency-low">phase-currentcost (v0.4.0) unstable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="change.html#phase-currentcost-v0-3-9-unstable-urgency-low">phase-currentcost (v0.3.9) unstable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="change.html#phase-currentcost-v0-3-8-unstable-urgency-low">phase-currentcost (v0.3.8) unstable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="change.html#phase-currentcost-v0-3-7-unstable-urgency-low">phase-currentcost (v0.3.7) unstable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="change.html#phase-currentcost-v0-3-6-unstable-urgency-low">phase-currentcost (v0.3.6) unstable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="change.html#phase-currentcost-v0-3-5-unstable-urgency-low">phase-currentcost (v0.3.5) unstable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="change.html#phase-currentcost-v0-3-4-unstable-urgency-low">phase-currentcost (v0.3.4) unstable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="change.html#phase-currentcost-v0-3-3-unstable-urgency-low">phase-currentcost (v0.3.3) unstable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="change.html#phase-currentcost-v0-3-2-unstable-urgency-low">phase-currentcost (v0.3.2) unstable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="change.html#phase-currentcost-v0-3-1-unstable-urgency-low">phase-currentcost (v0.3.1) unstable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="change.html#phase-currentcost-v0-3-0-unstable-urgency-low">phase-currentcost (v0.3.0) unstable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="change.html#phase-currentcost-v0-2-3-unstable-urgency-low">phase-currentcost (v0.2.3) unstable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="change.html#phase-currentcost-v0-2-2-unstable-urgency-low">phase-currentcost (v0.2.2) unstable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="change.html#phase-currentcost-v0-2-1-unstable-urgency-low">phase-currentcost (v0.2.1) unstable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="change.html#phase-currentcost-v0-2-0-unstable-urgency-low">phase-currentcost (v0.2.0) unstable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="change.html#phase-currentcost-v0-1-10-unstable-urgency-low">phase-currentcost (v0.1.10) unstable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="change.html#phase-currentcost-v0-1-9-unstable-urgency-low">phase-currentcost (v0.1.9) unstable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="change.html#phase-currentcost-v0-1-8-unstable-urgency-low">phase-currentcost (v0.1.8) unstable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="change.html#phase-currentcost-v0-1-7-unstable-urgency-low">phase-currentcost (v0.1.7) unstable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="change.html#phase-currentcost-v0-1-6-unstable-urgency-low">phase-currentcost (v0.1.6) unstable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="change.html#phase-currentcost-v0-1-5-unstable-urgency-low">phase-currentcost (v0.1.5) unstable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="change.html#phase-currentcost-v0-1-4-unstable-urgency-low">phase-currentcost (v0.1.4) unstable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="change.html#phase-currentcost-v0-1-3-unstable-urgency-low">phase-currentcost (v0.1.3) unstable; urgency=low</a></li>
</ul>
</li>
</ul>

        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">phase-currentcost</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>phase-currentcost</li>
      <li class="wy-breadcrumbs-aside">
        
          <a href="_sources/presentation.txt" rel="nofollow"> View page source</a>
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            
  <div class="section" id="phase-currentcost">
<h1>phase-currentcost<a class="headerlink" href="#phase-currentcost" title="Permalink to this headline">¶</a></h1>
<a class="reference external image-reference" href="https://travis-ci.org/liogen/phase-currentcost"><img alt="Travis CI Build Status" src="http://img.shields.io/travis/liogen/phase-currentcost.png?branch=master" /></a>
<a class="reference external image-reference" href="https://pypi.python.org/pypi/phase-currentcost"><img alt="Latest Version" src="http://img.shields.io/pypi/v/phase-currentcost.png" /></a>
<a class="reference external image-reference" href="https://pypi.python.org/pypi/phase-currentcost"><img alt="Downloads" src="http://img.shields.io/pypi/dm/phase-currentcost.png" /></a>
<a class="reference external image-reference" href="https://github.com/liogen/phase-currentcost"><img alt="License" src="http://img.shields.io/badge/license-MIT-red.png" /></a>
<p>CurrentCost data collector script for phase project.</p>
<p><a class="reference external" href="http://www.currentcost.com/product-envir.html">CurrentCost EnviR 128</a> is an appliance that monitor your electricity consumption and provide an <a class="reference external" href="http://www.currentcost.com/cc128/xml.htm">API</a> to retrieve data from USB cable.</p>
<p>phase-currentcost allow use to retrieve data from usb cable using <a class="reference external" href="http://pyserial.sourceforge.net/">pyserial</a> and transmit information to stdout or to <a class="reference external" href="https://www.rabbitmq.com/">RabbitMQ</a> using <a class="reference external" href="http://pika.readthedocs.org/en/latest/">Pika</a> module.</p>
<p>More precisly, this script collect instantaneous and historical data from Current Cost. It also take care of usb disconnection, Current Cost bad message format, timeout and power disconnection and send an error on stdout or on RabbitMQ each time for later anlysis. Also it create an udev rule to transform /dev/ttyUSB* to /dev/currentcost for serial port connection.</p>
<p>For more information, full documentation is available on <a class="reference external" href="http://phase-currentcost.readthedocs.org/en/latest/">readthedocs.org</a></p>
<div class="section" id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<p>Requirements:</p>
<blockquote>
<div><ul class="simple">
<li>Platform: Unix (only tested on Ubuntu 12.04)</li>
<li>Python 2.7</li>
<li>Pip (last version)</li>
<li>RabbitMQ (last version)</li>
</ul>
</div></blockquote>
<p>To install this software, you need to install python 2.7 and pip</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>sudo apt-get install python python-pip
<span class="nv">$ </span>sudo pip install --upgrade pip
</pre></div>
</div>
<p>Then, you have to install and configure RabbitMQ (change &#8220;admin&#8221; and &#8220;password&#8221; by your credential)</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ USERNAME</span><span class="o">=</span><span class="s2">&quot;admin&quot;</span>
<span class="nv">$ PASSWORD</span><span class="o">=</span><span class="s2">&quot;password&quot;</span>
<span class="nv">$ </span><span class="nb">echo</span> <span class="s2">&quot;deb http://www.rabbitmq.com/debian/ testing main&quot;</span> &gt; sudo /etc/apt/sources.list.d/rabbitmq.list
<span class="nv">$ </span>wget http://www.rabbitmq.com/rabbitmq-signing-key-public.asc
<span class="nv">$ </span>sudo apt-key add rabbitmq-signing-key-public.asc
<span class="nv">$ </span>sudo apt-get update
<span class="nv">$ </span>sudo apt-get install rabbitmq-server -y
<span class="nv">$ </span>sudo service rabbitmq-server start
<span class="c"># If you get a &#39;command not found&#39; error for this line, use /usr/lib/rabbitmq/bin/rabbitmq-plugins instead</span>
<span class="nv">$ </span>sudo rabbitmq-plugins <span class="nb">enable </span>rabbitmq_management
<span class="nv">$ </span>sudo rabbitmqctl add_user <span class="nv">$USERNAME</span> <span class="nv">$PASSWORD</span>
<span class="nv">$ </span>sudo rabbitmqctl set_user_tags <span class="nv">$USERNAME</span> administrator
<span class="nv">$ </span>sudo rabbitmqctl set_permissions -p / <span class="nv">$USERNAME</span> <span class="s2">&quot;.*&quot;</span> <span class="s2">&quot;.*&quot;</span> <span class="s2">&quot;.*&quot;</span>
<span class="nv">$ </span>sudo rabbitmqctl delete_user guest
<span class="nv">$ </span>sudo service rabbitmq-server restart
</pre></div>
</div>
<p>Then you can install phase-currentcost</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>sudo pip install phase-currentcost
</pre></div>
</div>
</div>
<div class="section" id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>sudo phase-currentcost -h
usage: phase-currentcost <span class="o">[</span>-h<span class="o">]</span> <span class="o">[</span>-t TTY_PORT<span class="o">]</span> <span class="o">[</span>-r RABBITMQ_CREDENTIAL<span class="o">]</span>
                         <span class="o">[</span>-l LOG_CONF<span class="o">]</span> <span class="o">[</span>-v<span class="o">]</span>
                         variable_name site_name

positional arguments:
  variable_name         name of the variable
  site_name             name of the location of the variable

optional arguments:
  -h, --help            show this <span class="nb">help </span>message and <span class="nb">exit</span>
  -t TTY_PORT, --tty-port TTY_PORT
                        tty port to connect to current cost
  -r RABBITMQ_CREDENTIAL, --rabbitmq-credential RABBITMQ_CREDENTIAL
                        credential <span class="k">for </span>rabbitMQ. By default, RabbitMQ is
                        deactivated. To activate it you have to give your
                        credential. Format: username:password.
  -l LOG_CONF, --log-conf LOG_CONF
                        path to log configuration
  -v, --verbose         activate verbose mode
</pre></div>
</div>
<p>By default:</p>
<ul class="simple">
<li>We targetting /dev/currentcost as tty port. You can over-write it using &#8211;tty-port argument.</li>
<li>RabbitMQ is not activated. We send message to stdout so you can collect it on file. If you want to share your message over the network using RabbitMQ, you can activate this function using &#8211;rabbitMQ-credential argument and giving your credential followinf this format: username:password.</li>
<li>Log configuration file is located in /opt/phase/phase-currentcost.conf and log file is in /var/logs/phase/phase-currentcost.log. You can set log configuration file using -l option with a path to your log.conf file.</li>
</ul>
</div>
<div class="section" id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<p>To see the current consumption on Current cost on stdout use:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>sudo phase-currentcost electric_meter liogen_home --tty-port /dev/currentcost
<span class="o">{</span><span class="s2">&quot;variableID&quot;</span>: <span class="s2">&quot;electric_meter&quot;</span>, <span class="s2">&quot;dstTimezone&quot;</span>: <span class="s2">&quot;UTC&quot;</span>, <span class="s2">&quot;siteID&quot;</span>: <span class="s2">&quot;liogen_home&quot;</span>, <span class="s2">&quot;date&quot;</span>: <span class="s2">&quot;2014-04-25T12:00:17.754959&quot;</span>, <span class="s2">&quot;message&quot;</span>: <span class="s2">&quot;CurrentCost electric_meter in liogen_home: TTY connection problem: /dev/currentcost is unreachable. Retry connection in 5 seconds.&quot;</span>, <span class="s2">&quot;nonDstTimezone&quot;</span>: <span class="s2">&quot;UTC&quot;</span><span class="o">}</span>
<span class="o">{</span><span class="s2">&quot;variableID&quot;</span>: <span class="s2">&quot;electric_meter&quot;</span>, <span class="s2">&quot;dstTimezone&quot;</span>: <span class="s2">&quot;UTC&quot;</span>, <span class="s2">&quot;siteID&quot;</span>: <span class="s2">&quot;liogen_home&quot;</span>, <span class="s2">&quot;date&quot;</span>: <span class="s2">&quot;2014-04-25T12:00:22.769256&quot;</span>, <span class="s2">&quot;message&quot;</span>: <span class="s2">&quot;CurrentCost electric_meter in liogen_home: TTY connection problem: /dev/currentcost is unreachable. Retry connection in 5 seconds.&quot;</span>, <span class="s2">&quot;nonDstTimezone&quot;</span>: <span class="s2">&quot;UTC&quot;</span><span class="o">}</span>
<span class="o">{</span><span class="s2">&quot;variableID&quot;</span>: <span class="s2">&quot;electric_meter&quot;</span>, <span class="s2">&quot;dstTimezone&quot;</span>: <span class="s2">&quot;UTC&quot;</span>, <span class="s2">&quot;siteID&quot;</span>: <span class="s2">&quot;liogen_home&quot;</span>, <span class="s2">&quot;date&quot;</span>: <span class="s2">&quot;2014-04-25T12:00:22.769256&quot;</span>, <span class="s2">&quot;message&quot;</span>: <span class="s2">&quot;&lt;msg&gt;&lt;src&gt;CC128-v1.29&lt;/src&gt;&lt;dsb&gt;00786&lt;/dsb&gt;&lt;time&gt;00:31:36&lt;/time&gt;&lt;tmpr&gt;19.3&lt;/tmpr&gt;&lt;sensor&gt;0&lt;/sensor&gt;&lt;id&gt;00077&lt;/id&gt;&lt;type&gt;1&lt;/type&gt;&lt;ch1&gt;&lt;watts&gt;00405&lt;/watts&gt;&lt;/ch1&gt;&lt;/msg&gt;&quot;</span>, <span class="s2">&quot;nonDstTimezone&quot;</span>: <span class="s2">&quot;UTC&quot;</span><span class="o">}</span>
</pre></div>
</div>
<p>With rabbitMQ message over the network with verbose mode activated:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>sudo phase-currentcost electric_meter liogen_home --tty-port /dev/currentcost --rabbitmq-credential admin:password -v
Starting current cost application
Current <span class="nb">time</span>: 2014-04-25 12:01:34.350781
Variable name: electric_meter
Site name: liogen_home
TTY port: /dev/currentcost

<span class="o">{</span><span class="s2">&quot;variableID&quot;</span>: <span class="s2">&quot;electric_meter&quot;</span>, <span class="s2">&quot;dstTimezone&quot;</span>: <span class="s2">&quot;UTC&quot;</span>, <span class="s2">&quot;siteID&quot;</span>: <span class="s2">&quot;liogen_home&quot;</span>, <span class="s2">&quot;date&quot;</span>: <span class="s2">&quot;2014-04-25T12:00:22.769256&quot;</span>, <span class="s2">&quot;message&quot;</span>: <span class="s2">&quot;&lt;msg&gt;&lt;src&gt;CC128-v1.29&lt;/src&gt;&lt;dsb&gt;00786&lt;/dsb&gt;&lt;time&gt;00:31:36&lt;/time&gt;&lt;tmpr&gt;19.3&lt;/tmpr&gt;&lt;sensor&gt;0&lt;/sensor&gt;&lt;id&gt;00077&lt;/id&gt;&lt;type&gt;1&lt;/type&gt;&lt;ch1&gt;&lt;watts&gt;00405&lt;/watts&gt;&lt;/ch1&gt;&lt;/msg&gt;&quot;</span>, <span class="s2">&quot;nonDstTimezone&quot;</span>: <span class="s2">&quot;UTC&quot;</span><span class="o">}</span>
<span class="o">{</span><span class="s2">&quot;variableID&quot;</span>: <span class="s2">&quot;electric_meter&quot;</span>, <span class="s2">&quot;dstTimezone&quot;</span>: <span class="s2">&quot;UTC&quot;</span>, <span class="s2">&quot;siteID&quot;</span>: <span class="s2">&quot;liogen_home&quot;</span>, <span class="s2">&quot;date&quot;</span>: <span class="s2">&quot;2014-04-25T12:00:22.769256&quot;</span>, <span class="s2">&quot;message&quot;</span>: <span class="s2">&quot;&lt;msg&gt;&lt;src&gt;CC128-v1.29&lt;/src&gt;&lt;dsb&gt;00786&lt;/dsb&gt;&lt;time&gt;00:31:36&lt;/time&gt;&lt;tmpr&gt;19.3&lt;/tmpr&gt;&lt;sensor&gt;0&lt;/sensor&gt;&lt;id&gt;00077&lt;/id&gt;&lt;type&gt;1&lt;/type&gt;&lt;ch1&gt;&lt;watts&gt;00405&lt;/watts&gt;&lt;/ch1&gt;&lt;/msg&gt;&quot;</span>, <span class="s2">&quot;nonDstTimezone&quot;</span>: <span class="s2">&quot;UTC&quot;</span><span class="o">}</span>
</pre></div>
</div>
</div>
<div class="section" id="message-send-through-rabbitmq">
<h2>Message send through RabbitMQ<a class="headerlink" href="#message-send-through-rabbitmq" title="Permalink to this headline">¶</a></h2>
<p>A message is a JSON containing this properties:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">variableID:</th><td class="field-body">Name of the variable</td>
</tr>
<tr class="field-even field"><th class="field-name">siteID:</th><td class="field-body">Name of the site</td>
</tr>
<tr class="field-odd field"><th class="field-name">date:</th><td class="field-body">Date in UTC</td>
</tr>
<tr class="field-even field"><th class="field-name">dstTimezone:</th><td class="field-body">Timezone with DST</td>
</tr>
<tr class="field-odd field"><th class="field-name">nonDstTimezone:</th><td class="field-body">Timezone without DST</td>
</tr>
<tr class="field-even field"><th class="field-name">message:</th><td class="field-body">Message to deliver through RabbitMQ</td>
</tr>
</tbody>
</table>
<p>Messages list:</p>
<table border="1" class="docutils">
<colgroup>
<col width="13%" />
<col width="34%" />
<col width="53%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Channel</th>
<th class="head">Message</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>error</td>
<td>utils.TTY_CONNECTION_PROBLEM</td>
<td>Send when TTY port is not reachable</td>
</tr>
<tr class="row-odd"><td>error</td>
<td>utils.CURRENTCOST_TIMEOUT</td>
<td>Send when TTY port is connected but reach timeout</td>
</tr>
<tr class="row-even"><td>error</td>
<td>utils.CC_INCORRECT_MESSAGE</td>
<td>Send when Currentcost send an invalid message</td>
</tr>
<tr class="row-odd"><td>currentcost</td>
<td>CurrentCost XML message</td>
<td>Send Currentcost XML message</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="contribute">
<h2>Contribute<a class="headerlink" href="#contribute" title="Permalink to this headline">¶</a></h2>
<p>I am more than happy to accept external contributions like feedback, bug reports and pull requests.</p>
<p>Do not hesitate to post an <a class="reference external" href="https://github.com/liogen/phase-currentcost/issues">issue</a> if you have any problem to install or to use this software.</p>
<p>You can also use this way to ask for a Feature request. I am also available to answer you on <a class="reference external" href="http://stackoverflow.com/questions/tagged/phase-currentcost">Stack Overflow</a></p>
<p>Here is the development process to test and validate your features.</p>
<ol class="arabic">
<li><p class="first">Prepare your development environment:</p>
<blockquote>
<div><div class="highlight-bash"><div class="highlight"><pre><span class="c"># `Socat &lt;http://www.dest-unreach.org/socat/&gt;`_ is usefull to create socket connection between 2 files.</span>
<span class="nv">$ </span>sudo apt-get install socat vim git-core
<span class="c"># Install virtualenv and virtualenvwrapper if it&#39;s not done.</span>
<span class="nv">$ </span>sudo pip install virtualenvwrapper
<span class="nv">$ </span>mkdir ~/.virtualenvs
<span class="nv">$ </span>vim ~/.bashrc
<span class="c"># Modify your ~/.bashrc and add this 2 lines:</span>
<span class="c"># export WORKON_HOME=~/.virtualenvs</span>
<span class="c"># source /usr/local/bin/virtualenvwrapper.sh</span>
<span class="nv">$ </span>bash
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">Go on <a class="reference external" href="https://github.com/liogen/phase-currentcost">github</a> and fork this project.</p>
</li>
<li><p class="first">Clone it on your conputer:</p>
<blockquote>
<div><div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span><span class="nb">cd</span> &lt;your_workspace&gt;
<span class="nv">$ </span>git clone git@github.com:&lt;username&gt;/phase-currentcost.git
<span class="nv">$ </span>git checkout develop
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">Prepare your virtualenv</p>
<blockquote>
<div><div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>mkvirtualenv phase
<span class="o">(</span>phase<span class="o">)</span><span class="nv">$ </span>pip install paver
<span class="o">(</span>phase<span class="o">)</span><span class="nv">$ </span>paver prepare
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">Add functional or unit tests</p>
</li>
<li><p class="first">Code your features</p>
</li>
<li><p class="first">To validate your implementation, launch:</p>
<blockquote>
<div><div class="highlight-bash"><div class="highlight"><pre><span class="o">(</span>phase<span class="o">)</span><span class="nv">$ </span>paver validate
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">Modify Todo, Changelog and update documentation</p>
</li>
<li><p class="first">Commit and push on github:</p>
<blockquote>
<div><div class="highlight-bash"><div class="highlight"><pre><span class="o">(</span>phase<span class="o">)</span><span class="nv">$ </span>git add .
<span class="o">(</span>phase<span class="o">)</span><span class="nv">$ </span>git commit -a -m <span class="s2">&quot;&lt;your commit message&gt;&quot;</span>
<span class="o">(</span>phase<span class="o">)</span><span class="nv">$ </span>git push origin develop
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">Propose a pull request on github</p>
</li>
</ol>
</div>
<div class="section" id="license">
<h2>License<a class="headerlink" href="#license" title="Permalink to this headline">¶</a></h2>
<p>The MIT License (MIT)</p>
<p>Copyright (c) 2014 Pierre Leray</p>
<p>Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the &#8220;Software&#8221;), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:</p>
<p>The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.</p>
<p>THE SOFTWARE IS PROVIDED &#8220;AS IS&#8221;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.</p>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="code.html" class="btn btn-neutral float-right" title="Modules"/>Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral" title="phase-currentcost"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2014, Pierre Leray.
    </p>
  </div>

  <a href="https://github.com/snide/sphinx_rtd_theme">Sphinx theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.0.2',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>