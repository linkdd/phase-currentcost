<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>phase-currentcost &mdash; phase-currentcost 0.9.4 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.9.4',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="phase-currentcost 0.9.4 documentation" href="#" />
    <link rel="next" title="Modules" href="code.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="code.html" title="Modules"
             accesskey="N">next</a> |</li>
        <li><a href="#">phase-currentcost 0.9.4 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="phase-currentcost">
<h1>phase-currentcost<a class="headerlink" href="#phase-currentcost" title="Permalink to this headline">¶</a></h1>
<a class="reference external image-reference" href="https://travis-ci.org/liogen/phase-currentcost"><img alt="Travis CI Build Status" src="https://api.travis-ci.org/liogen/phase-currentcost.png?branch=master" /></a>
<p>Functional test with fixtures to simulate CurrentCost on port COM and waited for currentCost to send messages.</p>
<p>TO BE COMPLETED (goals of the project)</p>
<p>List of features:</p>
<blockquote>
<div><ul class="simple">
<li>support usb disconnexion</li>
<li>send instant consumption</li>
<li>send historical consumption</li>
<li>send timeout message</li>
<li>send bad formated message eroor</li>
<li>To be completed</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="dependencies">
<h1>Dependencies<a class="headerlink" href="#dependencies" title="Permalink to this headline">¶</a></h1>
<p>TO BE COMPLETED</p>
<blockquote>
<div><ul class="simple">
<li>rabbitMQ</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="installation">
<h1>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h1>
<p>TO BE COMPLETED</p>
</div>
<div class="section" id="usage">
<h1>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h1>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>currentcost -h
usage: currentcost <span class="o">[</span>-h<span class="o">]</span> <span class="o">[</span>-t TTY_PORT<span class="o">]</span> <span class="o">[</span>-r RABBITMQ_CREDENTIAL<span class="o">]</span> <span class="o">[</span>-v<span class="o">]</span>
                   variable_name site_name

positional arguments:
  variable_name         name of the variable
  site_name             name of the location of the variable

optional arguments:
  -h, --help            show this <span class="nb">help </span>message and <span class="nb">exit</span>
  -t TTY_PORT, --tty-port TTY_PORT
                        tty port to connect to current cost
  -r RABBITMQ_CREDENTIAL, --rabbitMQ-credential RABBITMQ_CREDENTIAL
                        credential <span class="k">for </span>rabbitMQ. By default, RabbitMQ is
                        deactivated. To activate it you have to give your
                        credential. Format: username:password.
  -v, --verbose         activate verbose mode
</pre></div>
</div>
<p>By default:</p>
<ul class="simple">
<li>We are looking for default tty port located in /dev/currentcost. You can over-write it if you want using &#8211;tty-port argument.</li>
<li>RabbitMQ is not activated. To activate it you have to add your credential to currentcost script. To give your credential to currentcost script, use &#8211;rabbitMQ-credential argument.</li>
<li>If RabbitMQ is not activated, we display currentcost message in stdout. Else we send it over the network.</li>
</ul>
<p>Examples:</p>
<p>To see the current consumption on Current cost on stdout use:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>currentcost electric_meter liogen_home --tty-port /dev/currentcost
</pre></div>
</div>
<p><strong>IDEA: PUT CONSOLE OUTPUT AS AN EXAMPLE</strong></p>
<p>With rabbitMQ message over the network:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>currentcost electric_meter liogen_home --tty-port /dev/currentcost --rabbitMQ-credential admin:password -v
</pre></div>
</div>
<p><strong>IDEA: PUT CONSOLE OUTPUT AS AN EXAMPLE</strong></p>
</div>
<div class="section" id="development-process">
<h1>Development process<a class="headerlink" href="#development-process" title="Permalink to this headline">¶</a></h1>
<p>Install socat</p>
<div class="section" id="philosophy">
<h2>Philosophy<a class="headerlink" href="#philosophy" title="Permalink to this headline">¶</a></h2>
<p>In this project, we will try to use the best practices of the development.</p>
<ul>
<li><dl class="first docutils">
<dt><strong>Scenario based design</strong></dt>
<dd><ul class="first last simple">
<li>Take a paper and write what you code should do and how it should do using a story. (DESCRIBE MORE)</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><strong>Document driven-design</strong></dt>
<dd><ul class="first last simple">
<li>Take a minute and update documentation before coding (global documentation, code comment, test comment).</li>
<li>Always keep a clear release road map. Update it if needed.</li>
<li>Update README.md, CHANGELOG.txt, TODO.md as soon as possible.</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><strong>Behavior driven development</strong></dt>
<dd><ul class="first last simple">
<li>Add one functional test.</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><strong>Test driven development</strong></dt>
<dd><ul class="first last simple">
<li>Add one unit test while you don&#8217;t pass this functional test</li>
<li>Develop function while you don&#8217;t pass this unit test</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><strong>Code version</strong></dt>
<dd><ul class="first last simple">
<li>Commit after each new implemented function</li>
<li>Create a release after each validation of functional test</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><strong>Refactoring</strong></dt>
<dd><ul class="first last simple">
<li>Refactor code to improve readability, avoid code redundancy, speed compute time</li>
<li>Return to BDD part.</li>
</ul>
</dd>
</dl>
</li>
</ul>
</div>
<div class="section" id="setup-environment">
<h2>Setup environment<a class="headerlink" href="#setup-environment" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><strong>IDEA: Explain virtualenv and virtualenvwrapper</strong></li>
<li><strong>IDEA: Create a init script that ask several question and bootstrap project (plug-in)</strong></li>
<li><strong>IDEA: generate_setup to use sdist command</strong></li>
<li><strong>IDEA: test new plugin creation on TimeSeriesLogger</strong></li>
<li><strong>IDEA: move phase-currentcost.py outside of phase</strong></li>
<li><strong>IDEA: phase in development should provide init script to init and register new plugin</strong></li>
</ul>
<p><strong>TO BE COMPLETED</strong></p>
</div>
</div>
<div class="section" id="work-flow">
<h1>Work flow<a class="headerlink" href="#work-flow" title="Permalink to this headline">¶</a></h1>
<p><strong>TO BE MOVED</strong></p>
<div class="section" id="nominal-case">
<h2>Nominal case<a class="headerlink" href="#nominal-case" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p class="first">N1: Service started</p>
</li>
<li><dl class="first docutils">
<dt>N2: Arguments analysis</dt>
<dd><ul class="first last simple">
<li>E1: Missing argument. Return an error and log it</li>
<li>E2: Bad value for an argument. Return and error and log it</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>N3: Connexion to current cost</dt>
<dd><ul class="first last simple">
<li>E3: Unable to connect to current cost. Send a message over the network to inform that it is not possible to connect to current cost and log it. Return to step N3.</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>N4: Waited for a message from current cost</dt>
<dd><ul class="first last simple">
<li>E4: If no message received after 30 seconds, send a message over the network to inform that there is a problem with current cost and log it. Return to step N4.</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>N5: XML message received and analyzed</dt>
<dd><ul class="first last simple">
<li>E5: Incorrect message. Log this message and return to step N4. (to be defined)</li>
</ul>
</dd>
</dl>
</li>
<li><p class="first">N6: Creation of a network message looking like {variableID: ..., date: ..., message: ...}</p>
</li>
<li><dl class="first docutils">
<dt>N7: Send this message over the network.</dt>
<dd><ul class="first last simple">
<li>E6: Problem during message sending. Retry and log this error.</li>
</ul>
</dd>
</dl>
</li>
<li><p class="first">N8: Message sent over the network. Return to step N4.</p>
</li>
</ul>
</div>
<div class="section" id="alternative-cases">
<h2>Alternative cases<a class="headerlink" href="#alternative-cases" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>A1: USB port disconnected. Log this error, send an error message over the network and retry to reconnect to the USB port. If USB port reconnected, return to step N2.</li>
</ul>
</div>
</div>
<div class="section" id="test-plan">
<h1>Test plan<a class="headerlink" href="#test-plan" title="Permalink to this headline">¶</a></h1>
<p><strong>TO BE MOVED</strong></p>
<p><strong>IDEA: Link to features/currentcost.feature</strong></p>
<p>Look at features/currentcost.feature</p>
</div>
<div class="section" id="license">
<h1>License<a class="headerlink" href="#license" title="Permalink to this headline">¶</a></h1>
<p>The MIT License (MIT)</p>
<p>Copyright (c) 2014 Pierre Leray</p>
<p>Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the &#8220;Software&#8221;), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:</p>
<p>The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.</p>
<p>THE SOFTWARE IS PROVIDED &#8220;AS IS&#8221;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.</p>
</div>
<div class="section" id="more">
<h1>More<a class="headerlink" href="#more" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="code.html">Modules</a><ul>
<li class="toctree-l2"><a class="reference internal" href="code.html#module-currentcost.utils">Utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="code.html#module-currentcost.rabbitmq_messager">RabbitMQ_messager</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="todo.html">TODO v1.0.0</a><ul>
<li class="toctree-l2"><a class="reference internal" href="todo.html#objectives">Objectives</a></li>
<li class="toctree-l2"><a class="reference internal" href="todo.html#schedule">Schedule</a></li>
<li class="toctree-l2"><a class="reference internal" href="todo.html#pending-tasks">Pending tasks</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="changes.html">CHANGELOG</a><ul>
<li class="toctree-l2"><a class="reference internal" href="changes.html#phase-currentcost-v0-9-4-stable-urgency-low">phase-currentcost (v0.9.4) stable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="changes.html#phase-currentcost-v0-9-3-stable-urgency-low">phase-currentcost (v0.9.3) stable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="changes.html#phase-currentcost-v0-9-2-stable-urgency-low">phase-currentcost (v0.9.2) stable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="changes.html#phase-currentcost-v0-9-1-stable-urgency-low">phase-currentcost (v0.9.1) stable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="changes.html#phase-currentcost-v0-9-0-stable-urgency-low">phase-currentcost (v0.9.0) stable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="changes.html#phase-currentcost-v0-8-0-unstable-urgency-low">phase-currentcost (v0.8.0) unstable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="changes.html#phase-currentcost-v0-7-0-unstable-urgency-low">phase-currentcost (v0.7.0) unstable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="changes.html#phase-currentcost-v0-6-0-unstable-urgency-low">phase-currentcost (v0.6.0) unstable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="changes.html#phase-currentcost-v0-5-0-unstable-urgency-low">phase-currentcost (v0.5.0) unstable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="changes.html#phase-currentcost-v0-4-1-unstable-urgency-low">phase-currentcost (v0.4.1) unstable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="changes.html#phase-currentcost-v0-4-0-unstable-urgency-low">phase-currentcost (v0.4.0) unstable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="changes.html#phase-currentcost-v0-3-9-unstable-urgency-low">phase-currentcost (v0.3.9) unstable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="changes.html#phase-currentcost-v0-3-8-unstable-urgency-low">phase-currentcost (v0.3.8) unstable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="changes.html#phase-currentcost-v0-3-7-unstable-urgency-low">phase-currentcost (v0.3.7) unstable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="changes.html#phase-currentcost-v0-3-6-unstable-urgency-low">phase-currentcost (v0.3.6) unstable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="changes.html#phase-currentcost-v0-3-5-unstable-urgency-low">phase-currentcost (v0.3.5) unstable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="changes.html#phase-currentcost-v0-3-4-unstable-urgency-low">phase-currentcost (v0.3.4) unstable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="changes.html#phase-currentcost-v0-3-3-unstable-urgency-low">phase-currentcost (v0.3.3) unstable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="changes.html#phase-currentcost-v0-3-2-unstable-urgency-low">phase-currentcost (v0.3.2) unstable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="changes.html#phase-currentcost-v0-3-1-unstable-urgency-low">phase-currentcost (v0.3.1) unstable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="changes.html#phase-currentcost-v0-3-0-unstable-urgency-low">phase-currentcost (v0.3.0) unstable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="changes.html#phase-currentcost-v0-2-3-unstable-urgency-low">phase-currentcost (v0.2.3) unstable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="changes.html#phase-currentcost-v0-2-2-unstable-urgency-low">phase-currentcost (v0.2.2) unstable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="changes.html#phase-currentcost-v0-2-1-unstable-urgency-low">phase-currentcost (v0.2.1) unstable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="changes.html#phase-currentcost-v0-2-0-unstable-urgency-low">phase-currentcost (v0.2.0) unstable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="changes.html#phase-currentcost-v0-1-10-unstable-urgency-low">phase-currentcost (v0.1.10) unstable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="changes.html#phase-currentcost-v0-1-9-unstable-urgency-low">phase-currentcost (v0.1.9) unstable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="changes.html#phase-currentcost-v0-1-8-unstable-urgency-low">phase-currentcost (v0.1.8) unstable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="changes.html#phase-currentcost-v0-1-7-unstable-urgency-low">phase-currentcost (v0.1.7) unstable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="changes.html#phase-currentcost-v0-1-6-unstable-urgency-low">phase-currentcost (v0.1.6) unstable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="changes.html#phase-currentcost-v0-1-5-unstable-urgency-low">phase-currentcost (v0.1.5) unstable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="changes.html#phase-currentcost-v0-1-4-unstable-urgency-low">phase-currentcost (v0.1.4) unstable; urgency=low</a></li>
<li class="toctree-l2"><a class="reference internal" href="changes.html#phase-currentcost-v0-1-3-unstable-urgency-low">phase-currentcost (v0.1.3) unstable; urgency=low</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><a class="reference internal" href="genindex.html"><em>Index</em></a></li>
<li><a class="reference internal" href="py-modindex.html"><em>Module Index</em></a></li>
<li><a class="reference internal" href="search.html"><em>Search Page</em></a></li>
</ul>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="#">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">phase-currentcost</a></li>
<li><a class="reference internal" href="#dependencies">Dependencies</a></li>
<li><a class="reference internal" href="#installation">Installation</a></li>
<li><a class="reference internal" href="#usage">Usage</a></li>
<li><a class="reference internal" href="#development-process">Development process</a><ul>
<li><a class="reference internal" href="#philosophy">Philosophy</a></li>
<li><a class="reference internal" href="#setup-environment">Setup environment</a></li>
</ul>
</li>
<li><a class="reference internal" href="#work-flow">Work flow</a><ul>
<li><a class="reference internal" href="#nominal-case">Nominal case</a></li>
<li><a class="reference internal" href="#alternative-cases">Alternative cases</a></li>
</ul>
</li>
<li><a class="reference internal" href="#test-plan">Test plan</a></li>
<li><a class="reference internal" href="#license">License</a></li>
<li><a class="reference internal" href="#more">More</a></li>
<li><a class="reference internal" href="#indices-and-tables">Indices and tables</a></li>
</ul>

  <h4>Next topic</h4>
  <p class="topless"><a href="code.html"
                        title="next chapter">Modules</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/index.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="code.html" title="Modules"
             >next</a> |</li>
        <li><a href="#">phase-currentcost 0.9.4 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2014, Pierre Leray.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
  </body>
</html>